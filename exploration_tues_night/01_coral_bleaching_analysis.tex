% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={01\_coral\_bleaching\_analysis.R},
  pdfauthor={laurenkay},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{01\_coral\_bleaching\_analysis.R}
\author{laurenkay}
\date{2025-08-05}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# 01: Comprehensive Coral Bleaching Data Loading and Initial Analysis}
\CommentTok{\# ============================================================================}
\CommentTok{\# Purpose: Load coral condition datasets, perform initial data exploration,}
\CommentTok{\#          calculate site{-}level statistics, and establish data{-}driven thresholds}
\CommentTok{\#          using actual quartiles rather than arbitrary cutoffs}
\CommentTok{\# Author: Coral Bleaching Analysis Pipeline}
\CommentTok{\# Date: Analysis of 2023{-}2025 bleaching events}
\CommentTok{\# ============================================================================}

\CommentTok{\# Load required libraries with explicit purpose for each}
\FunctionTok{library}\NormalTok{(dplyr)        }\CommentTok{\# Data manipulation and summarization}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)      }\CommentTok{\# Advanced plotting and visualization}
\FunctionTok{library}\NormalTok{(tidyr)        }\CommentTok{\# Data reshaping and tidying}
\FunctionTok{library}\NormalTok{(readr)        }\CommentTok{\# Efficient CSV reading}
\FunctionTok{library}\NormalTok{(corrplot)     }\CommentTok{\# Correlation matrix visualization}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## corrplot 0.92 loaded
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(gridExtra)    }\CommentTok{\# Multiple plot arrangement}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'gridExtra'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     combine
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(viridis)      }\CommentTok{\# Perceptually uniform color scales}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: viridisLite
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(scales)       }\CommentTok{\# Scale functions for plots}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'scales'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:viridis':
## 
##     viridis_pal
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:readr':
## 
##     col_factor
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
## v forcats   1.0.0     v stringr   1.5.1
## v lubridate 1.9.3     v tibble    3.2.1
## v purrr     1.0.2
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x scales::col_factor() masks readr::col_factor()
## x gridExtra::combine() masks dplyr::combine()
## x purrr::discard()     masks scales::discard()
## x dplyr::filter()      masks stats::filter()
## x dplyr::lag()         masks stats::lag()
## i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"============================================================================}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ============================================================================
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"CORAL BLEACHING DATA LOADING AND INITIAL ANALYSIS}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## CORAL BLEACHING DATA LOADING AND INITIAL ANALYSIS
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"============================================================================}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ============================================================================
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# DATA LOADING AND INITIAL EXPLORATION}
\CommentTok{\# ============================================================================}

\FunctionTok{cat}\NormalTok{(}\StringTok{"STEP 1: Loading coral condition datasets}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## STEP 1: Loading coral condition datasets
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ----------------------------------------
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load all three coral condition datasets}
\CommentTok{\# Rationale: We need extent, prevalence, and mortality data to get complete}
\CommentTok{\# picture of coral condition responses across different metrics}
\NormalTok{extent\_data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"s3pt1\_coralcondition\_bleachingextent\_33sites\_2022\_2025.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 987 Columns: 9
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (2): site, period
## dbl  (6): year, replicate, ext_bleached, ext_verypale, ext_anybleaching, ext...
## date (1): date
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{prevalence\_data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"s3pt1\_coralcondition\_bleachingprevalence\_33sites\_2022\_2025.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 987 Columns: 10
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (2): site, period
## dbl  (7): year, replicate, ncolonies, prev_bleached, prev_verypale, prev_any...
## date (1): date
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mortality\_data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"s3pt1\_coralcondition\_mortalityprevalence\_33sites\_2022\_2025.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 987 Columns: 10
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (2): site, period
## dbl  (7): year, replicate, ncolonies, prev_oldmortality, prev_recentmortalit...
## date (1): date
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load temperature data for context}
\NormalTok{temp\_data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"s4pt5\_temperatureWeeklyDHW\_45sites\_2003\_2025.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 36355 Columns: 9
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr (2): program, site
## dbl (7): year, week, depth, BT, weekly_max_temp, dhw, annual_max
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Display data dimensions and structure}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Dataset dimensions:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Dataset dimensions:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"  Extent data: \%d rows × \%d columns}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(extent\_data), }\FunctionTok{ncol}\NormalTok{(extent\_data)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Extent data: 987 rows × 9 columns
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"  Prevalence data: \%d rows × \%d columns}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(prevalence\_data), }\FunctionTok{ncol}\NormalTok{(prevalence\_data)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Prevalence data: 987 rows × 10 columns
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"  Mortality data: \%d rows × \%d columns}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(mortality\_data), }\FunctionTok{ncol}\NormalTok{(mortality\_data)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Mortality data: 987 rows × 10 columns
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"  Temperature data: \%d rows × \%d columns}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(temp\_data), }\FunctionTok{ncol}\NormalTok{(temp\_data)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Temperature data: 36355 rows × 9 columns
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Examine data structure and key variables}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Key variables in extent data:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Key variables in extent data:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\FunctionTok{names}\NormalTok{(extent\_data), }\AttributeTok{collapse =} \StringTok{", "}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## site, year, replicate, date, period, ext_bleached, ext_verypale, ext_anybleaching, ext_nobleaching
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Unique time periods in data:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Unique time periods in data:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{unique\_periods }\OtherTok{\textless{}{-}}\NormalTok{ extent\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{distinct}\NormalTok{(year, period) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(year, period)}
\FunctionTok{print}\NormalTok{(unique\_periods)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 5 x 2
##    year period
##   <dbl> <chr> 
## 1  2022 Annual
## 2  2023 Annual
## 3  2024 Annual
## 4  2024 PBL   
## 5  2025 PBL
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Total unique sites in extent data: \%d}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{n\_distinct}\NormalTok{(extent\_data}\SpecialCharTok{$}\NormalTok{site)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Total unique sites in extent data: 33
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"Year range: \%d {-} \%d}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{min}\NormalTok{(extent\_data}\SpecialCharTok{$}\NormalTok{year), }\FunctionTok{max}\NormalTok{(extent\_data}\SpecialCharTok{$}\NormalTok{year)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Year range: 2022 - 2025
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# DATA QUALITY ASSESSMENT}
\CommentTok{\# ============================================================================}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{STEP 2: Data quality assessment}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## STEP 2: Data quality assessment
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -------------------------------
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check for missing values in key variables}
\NormalTok{missing\_analysis }\OtherTok{\textless{}{-}}\NormalTok{ extent\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{missing\_site =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(site)),}
    \AttributeTok{missing\_year =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(year)),}
    \AttributeTok{missing\_period =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(period)),}
    \AttributeTok{missing\_anybleaching =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(ext\_anybleaching)),}
    \AttributeTok{missing\_bleached =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(ext\_bleached)),}
    \AttributeTok{missing\_nobleaching =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(ext\_nobleaching)),}
    \AttributeTok{total\_rows =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Missing data summary:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Missing data summary:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(missing\_analysis)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 7
##   missing_site missing_year missing_period missing_anybleaching missing_bleached
##          <int>        <int>          <int>                <int>            <int>
## 1            0            0              0                    0                0
## # i 2 more variables: missing_nobleaching <int>, total_rows <int>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check data completeness by site and time period}
\NormalTok{completeness\_check }\OtherTok{\textless{}{-}}\NormalTok{ extent\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(site, year, period) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{n\_replicates =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{complete\_cases =} \FunctionTok{sum}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(ext\_anybleaching)),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  )}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Replication summary:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Replication summary:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{replication\_summary }\OtherTok{\textless{}{-}}\NormalTok{ completeness\_check }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(n\_replicates) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{n\_site\_time\_combinations =} \FunctionTok{n}\NormalTok{(), }\AttributeTok{.groups =} \StringTok{"drop"}\NormalTok{)}
\FunctionTok{print}\NormalTok{(replication\_summary)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 2 x 2
##   n_replicates n_site_time_combinations
##          <int>                    <int>
## 1            5                        3
## 2            6                      162
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# VISUALIZATION 1: Data Availability Matrix}
\CommentTok{\# ============================================================================}

\CommentTok{\# Create data availability heatmap}
\CommentTok{\# Justification: Visual assessment of data gaps is crucial for understanding}
\CommentTok{\# which sites and timepoints have sufficient data for analysis}

\NormalTok{availability\_matrix }\OtherTok{\textless{}{-}}\NormalTok{ extent\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(site, year, period) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{data\_availability =} \SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(}\FunctionTok{first}\NormalTok{(ext\_anybleaching)), }\AttributeTok{.groups =} \StringTok{"drop"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{timepoint =} \FunctionTok{paste}\NormalTok{(year, period, }\AttributeTok{sep =} \StringTok{"\_"}\NormalTok{))}

\NormalTok{p1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(availability\_matrix, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint, }\AttributeTok{y =} \FunctionTok{reorder}\NormalTok{(site, year), }\AttributeTok{fill =}\NormalTok{ data\_availability)) }\SpecialCharTok{+}
  \FunctionTok{geom\_tile}\NormalTok{(}\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{size =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"FALSE"} \OtherTok{=} \StringTok{"red"}\NormalTok{, }\StringTok{"TRUE"} \OtherTok{=} \StringTok{"darkgreen"}\NormalTok{), }
                    \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Missing"}\NormalTok{, }\StringTok{"Available"}\NormalTok{),}
                    \AttributeTok{name =} \StringTok{"Data Status"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Data Availability Matrix Across Sites and Time Periods"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Green = data available, Red = missing data"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Time Period (Year\_Period)"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Monitoring Site"}\NormalTok{,}
    \AttributeTok{caption =} \StringTok{"This heatmap reveals data gaps that could affect analysis completeness.}\SpecialCharTok{\textbackslash{}n}\StringTok{Complete temporal coverage is essential for recovery trajectory analysis."}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
    \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{8}\NormalTok{),}
    \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \DecValTok{0}\NormalTok{, }\AttributeTok{size =} \DecValTok{9}\NormalTok{, }\AttributeTok{color =} \StringTok{"gray30"}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## i Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"01\_plot\_data\_availability\_matrix.png"}\NormalTok{, p1, }\AttributeTok{width =} \DecValTok{12}\NormalTok{, }\AttributeTok{height =} \DecValTok{10}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Saved: 01\_plot\_data\_availability\_matrix.png}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Saved: 01_plot_data_availability_matrix.png
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# SITE{-}LEVEL DATA AGGREGATION}
\CommentTok{\# ============================================================================}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{STEP 3: Calculating site{-}level means across replicates}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## STEP 3: Calculating site-level means across replicates
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ------------------------------------------------------
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Function to calculate site{-}level means}
\CommentTok{\# Rationale: Multiple replicates per site need to be averaged to get }
\CommentTok{\# representative site{-}level values for analysis}
\NormalTok{calculate\_site\_means }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data, }\AttributeTok{group\_vars =} \FunctionTok{c}\NormalTok{(}\StringTok{"site"}\NormalTok{, }\StringTok{"year"}\NormalTok{, }\StringTok{"period"}\NormalTok{)) \{}
  \CommentTok{\# Calculate means across replicates, excluding NA values}
  \CommentTok{\# This preserves data where some but not all replicates are missing}
\NormalTok{  result }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{group\_by}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{all\_of}\NormalTok{(group\_vars))) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{summarise}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.numeric), }\SpecialCharTok{\textasciitilde{}} \FunctionTok{mean}\NormalTok{(.x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)), }\AttributeTok{.groups =} \StringTok{"drop"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \CommentTok{\# Remove rows where key variables are NaN (no valid replicates)}
    \CommentTok{\# filter(!is.nan(ext\_anybleaching))}
  
  \FunctionTok{return}\NormalTok{(result)}
\NormalTok{\}}

\CommentTok{\# Apply aggregation to all datasets}
\NormalTok{extent\_means }\OtherTok{\textless{}{-}} \FunctionTok{calculate\_site\_means}\NormalTok{(extent\_data)}
\NormalTok{prevalence\_means }\OtherTok{\textless{}{-}} \FunctionTok{calculate\_site\_means}\NormalTok{(prevalence\_data)  }
\NormalTok{mortality\_means }\OtherTok{\textless{}{-}} \FunctionTok{calculate\_site\_means}\NormalTok{(mortality\_data)}

\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"Original extent data: \%d rows}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(extent\_data)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Original extent data: 987 rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"Aggregated extent data: \%d site{-}year{-}period combinations}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(extent\_means)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Aggregated extent data: 165 site-year-period combinations
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"Data reduction: \%.1f\%\% (due to replicate averaging)}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }
\NormalTok{            (}\DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{nrow}\NormalTok{(extent\_means)}\SpecialCharTok{/}\FunctionTok{nrow}\NormalTok{(extent\_data)) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Data reduction: 83.3% (due to replicate averaging)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# KEY TIMEPOINT IDENTIFICATION}
\CommentTok{\# ============================================================================}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{STEP 4: Identifying key timepoints for 2023{-}2025 analysis}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## STEP 4: Identifying key timepoints for 2023-2025 analysis
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## --------------------------------------------------------
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Define the four critical timepoints for the analysis}
\CommentTok{\# Rationale: These timepoints capture the bleaching events and recovery periods}
\CommentTok{\# 2023 Annual: Baseline condition before major bleaching}
\CommentTok{\# 2024 PBL: Post{-}bleaching survey after 2023 stress}
\CommentTok{\# 2024 Annual: Condition before 2024 bleaching event  }
\CommentTok{\# 2025 PBL: Post{-}bleaching survey after 2024 stress (our main response variable)}

\NormalTok{key\_timepoints }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"2023\_Annual"}\NormalTok{, }\StringTok{"2024\_PBL"}\NormalTok{, }\StringTok{"2024\_Annual"}\NormalTok{, }\StringTok{"2025\_PBL"}\NormalTok{)}

\CommentTok{\# Check data availability for each key timepoint}
\NormalTok{timepoint\_availability }\OtherTok{\textless{}{-}}\NormalTok{ extent\_means }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}
\NormalTok{    (year }\SpecialCharTok{==} \DecValTok{2023} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"Annual"}\NormalTok{) }\SpecialCharTok{|}
\NormalTok{      (year }\SpecialCharTok{==} \DecValTok{2024} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"PBL"}\NormalTok{) }\SpecialCharTok{|}
\NormalTok{      (year }\SpecialCharTok{==} \DecValTok{2024} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"Annual"}\NormalTok{) }\SpecialCharTok{|}
\NormalTok{      (year }\SpecialCharTok{==} \DecValTok{2025} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"PBL"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{timepoint =} \FunctionTok{paste}\NormalTok{(year, period, }\AttributeTok{sep =} \StringTok{"\_"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(timepoint) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{n\_sites =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{mean\_bleaching =} \FunctionTok{mean}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{median\_bleaching =} \FunctionTok{median}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{min\_bleaching =} \FunctionTok{min}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{max\_bleaching =} \FunctionTok{max}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  )}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Data availability and basic statistics for key timepoints:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Data availability and basic statistics for key timepoints:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(timepoint\_availability)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 6
##   timepoint  n_sites mean_bleaching median_bleaching min_bleaching max_bleaching
##   <chr>        <int>          <dbl>            <dbl>         <dbl>         <dbl>
## 1 2023_Annu~      33          30.3             32.5              0          80.5
## 2 2024_Annu~      33          28.0             28.3              0          81.4
## 3 2024_PBL        33           4.24             0                0          31.7
## 4 2025_PBL        33           6.54             2.17             0          43.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Find sites with complete data across all four timepoints}
\NormalTok{complete\_sites }\OtherTok{\textless{}{-}}\NormalTok{ extent\_means }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}
\NormalTok{    (year }\SpecialCharTok{==} \DecValTok{2023} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"Annual"}\NormalTok{) }\SpecialCharTok{|}
\NormalTok{      (year }\SpecialCharTok{==} \DecValTok{2024} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"PBL"}\NormalTok{) }\SpecialCharTok{|}
\NormalTok{      (year }\SpecialCharTok{==} \DecValTok{2024} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"Annual"}\NormalTok{) }\SpecialCharTok{|}
\NormalTok{      (year }\SpecialCharTok{==} \DecValTok{2025} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"PBL"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{timepoint =} \FunctionTok{paste}\NormalTok{(year, period, }\AttributeTok{sep =} \StringTok{"\_"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(site) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{timepoints\_available =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{available\_timepoints =} \FunctionTok{paste}\NormalTok{(}\FunctionTok{sort}\NormalTok{(}\FunctionTok{unique}\NormalTok{(timepoint)), }\AttributeTok{collapse =} \StringTok{", "}\NormalTok{),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(timepoints\_available }\SpecialCharTok{==} \DecValTok{4}\NormalTok{)}

\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Sites with complete data across all 4 key timepoints: \%d}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(complete\_sites)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Sites with complete data across all 4 key timepoints: 33
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"These sites will form our core analysis dataset.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## These sites will form our core analysis dataset.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# VISUALIZATION 2: Bleaching Extent Distributions by Timepoint}
\CommentTok{\# ============================================================================}

\CommentTok{\# Create comprehensive distribution plots}
\CommentTok{\# Justification: Understanding the distribution of bleaching values across}
\CommentTok{\# timepoints reveals the severity and variability of bleaching events}

\NormalTok{timepoint\_data }\OtherTok{\textless{}{-}}\NormalTok{ extent\_means }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}
\NormalTok{    (year }\SpecialCharTok{==} \DecValTok{2023} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"Annual"}\NormalTok{) }\SpecialCharTok{|}
\NormalTok{      (year }\SpecialCharTok{==} \DecValTok{2024} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"PBL"}\NormalTok{) }\SpecialCharTok{|}
\NormalTok{      (year }\SpecialCharTok{==} \DecValTok{2024} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"Annual"}\NormalTok{) }\SpecialCharTok{|}
\NormalTok{      (year }\SpecialCharTok{==} \DecValTok{2025} \SpecialCharTok{\&}\NormalTok{ period }\SpecialCharTok{==} \StringTok{"PBL"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{timepoint =} \FunctionTok{paste}\NormalTok{(year, period, }\AttributeTok{sep =} \StringTok{"\_"}\NormalTok{),}
    \AttributeTok{timepoint\_ordered =} \FunctionTok{factor}\NormalTok{(timepoint, }\AttributeTok{levels =}\NormalTok{ key\_timepoints)}
\NormalTok{  )}

\CommentTok{\# Box plots with individual points}
\NormalTok{p2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(timepoint\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint\_ordered, }\AttributeTok{y =}\NormalTok{ ext\_anybleaching, }\AttributeTok{fill =}\NormalTok{ timepoint\_ordered)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_jitter}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{size =} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_viridis\_d}\NormalTok{(}\AttributeTok{name =} \StringTok{"Time Period"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Distribution of Bleaching Extent Across Key Timepoints"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Box plots show median, quartiles, and individual site values"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Time Period"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Bleaching Extent (\%)"}\NormalTok{,}
    \AttributeTok{caption =} \StringTok{"This plot reveals the severity of bleaching events and recovery patterns.}\SpecialCharTok{\textbackslash{}n}\StringTok{High values in 2024 Annual indicate severe bleaching, while lower 2025 PBL}\SpecialCharTok{\textbackslash{}n}\StringTok{values would indicate recovery. Outliers may represent particularly}\SpecialCharTok{\textbackslash{}n}\StringTok{resilient or vulnerable sites deserving detailed investigation."}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
    \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \DecValTok{0}\NormalTok{, }\AttributeTok{size =} \DecValTok{9}\NormalTok{, }\AttributeTok{color =} \StringTok{"gray30"}\NormalTok{)}
\NormalTok{  )}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"01\_plot\_bleaching\_distributions.png"}\NormalTok{, p2, }\AttributeTok{width =} \DecValTok{10}\NormalTok{, }\AttributeTok{height =} \DecValTok{7}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Saved: 01\_plot\_bleaching\_distributions.png}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Saved: 01_plot_bleaching_distributions.png
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# DATA{-}DRIVEN THRESHOLD CALCULATION}
\CommentTok{\# ============================================================================}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{STEP 5: Calculating data{-}driven thresholds using actual quartiles}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## STEP 5: Calculating data-driven thresholds using actual quartiles
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ------------------------------------------------------------------
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate quartiles for bleaching extent across all timepoints}
\CommentTok{\# Rationale: Using actual data quartiles provides objective, data{-}driven}
\CommentTok{\# thresholds rather than arbitrary cutoffs. This ensures our classifications}
\CommentTok{\# reflect the actual distribution of observed values.}

\NormalTok{all\_bleaching\_values }\OtherTok{\textless{}{-}}\NormalTok{ timepoint\_data}\SpecialCharTok{$}\NormalTok{ext\_anybleaching[}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(timepoint\_data}\SpecialCharTok{$}\NormalTok{ext\_anybleaching)]}

\NormalTok{bleaching\_quartiles }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(all\_bleaching\_values, }\AttributeTok{probs =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.75}\NormalTok{, }\FloatTok{1.0}\NormalTok{))}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Bleaching extent quartiles (all timepoints combined):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Bleaching extent quartiles (all timepoints combined):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(bleaching\_quartiles)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        0%       25%       50%       75%      100% 
##  0.000000  0.000000  9.083333 31.875000 81.416667
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate quartiles for each timepoint separately}
\CommentTok{\# Rationale: Different timepoints may have different baseline distributions}
\NormalTok{timepoint\_quartiles }\OtherTok{\textless{}{-}}\NormalTok{ timepoint\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(timepoint\_ordered) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{Q0\_min =} \FunctionTok{min}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Q1\_25th =} \FunctionTok{quantile}\NormalTok{(ext\_anybleaching, }\FloatTok{0.25}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Q2\_median =} \FunctionTok{median}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Q3\_75th =} \FunctionTok{quantile}\NormalTok{(ext\_anybleaching, }\FloatTok{0.75}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Q4\_max =} \FunctionTok{max}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  )}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Quartiles by timepoint:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Quartiles by timepoint:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(timepoint\_quartiles)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 7
##   timepoint_ordered     n Q0_min Q1_25th Q2_median Q3_75th Q4_max
##   <fct>             <int>  <dbl>   <dbl>     <dbl>   <dbl>  <dbl>
## 1 2023_Annual          33      0   15        32.5    40.4    80.5
## 2 2024_PBL             33      0    0         0       5      31.7
## 3 2024_Annual          33      0    3.33     28.3    42.3    81.4
## 4 2025_PBL             33      0    0         2.17    8.33   43.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Define bleaching severity categories based on overall quartiles}
\CommentTok{\# Rationale: Four categories based on quartiles provide balanced groups}
\CommentTok{\# while maintaining meaningful ecological interpretation}
\NormalTok{bleaching\_severity\_thresholds }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{minimal =}\NormalTok{ bleaching\_quartiles[}\DecValTok{2}\NormalTok{],      }\CommentTok{\# 0{-}25th percentile}
  \AttributeTok{moderate =}\NormalTok{ bleaching\_quartiles[}\DecValTok{3}\NormalTok{],     }\CommentTok{\# 25th{-}50th percentile  }
  \AttributeTok{high =}\NormalTok{ bleaching\_quartiles[}\DecValTok{4}\NormalTok{],         }\CommentTok{\# 50th{-}75th percentile}
  \AttributeTok{severe =}\NormalTok{ bleaching\_quartiles[}\DecValTok{5}\NormalTok{]        }\CommentTok{\# 75th{-}100th percentile}
\NormalTok{)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Data{-}driven bleaching severity categories:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Data-driven bleaching severity categories:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"  Minimal: 0 {-} \%.1f\%\%}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{minimal))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Minimal: 0 - 0.0%
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"  Moderate: \%.1f {-} \%.1f\%\%}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{minimal, bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{moderate))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Moderate: 0.0 - 9.1%
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"  High: \%.1f {-} \%.1f\%\%}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{moderate, bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{high))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   High: 9.1 - 31.9%
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"  Severe: \%.1f {-} \%.1f\%\%}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{high, bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{severe))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Severe: 31.9 - 81.4%
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Apply severity categories to data}
\NormalTok{timepoint\_data\_categorized }\OtherTok{\textless{}{-}}\NormalTok{ timepoint\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{severity\_category =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{      ext\_anybleaching }\SpecialCharTok{\textless{}=}\NormalTok{ bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{minimal }\SpecialCharTok{\textasciitilde{}} \StringTok{"Minimal"}\NormalTok{,}
\NormalTok{      ext\_anybleaching }\SpecialCharTok{\textless{}=}\NormalTok{ bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{moderate }\SpecialCharTok{\textasciitilde{}} \StringTok{"Moderate"}\NormalTok{, }
\NormalTok{      ext\_anybleaching }\SpecialCharTok{\textless{}=}\NormalTok{ bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{high }\SpecialCharTok{\textasciitilde{}} \StringTok{"High"}\NormalTok{,}
\NormalTok{      ext\_anybleaching }\SpecialCharTok{\textless{}=}\NormalTok{ bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{severe }\SpecialCharTok{\textasciitilde{}} \StringTok{"Severe"}\NormalTok{,}
      \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \StringTok{"Severe"}
\NormalTok{    ),}
    \AttributeTok{severity\_category =} \FunctionTok{factor}\NormalTok{(severity\_category, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Minimal"}\NormalTok{, }\StringTok{"Moderate"}\NormalTok{, }\StringTok{"High"}\NormalTok{, }\StringTok{"Severe"}\NormalTok{))}
\NormalTok{  )}

\CommentTok{\# ============================================================================}
\CommentTok{\# VISUALIZATION 3: Severity Category Distribution}
\CommentTok{\# ============================================================================}

\CommentTok{\# Create stacked bar chart of severity categories by timepoint}
\CommentTok{\# Justification: Shows how bleaching severity changes across timepoints}
\CommentTok{\# and validates that our quartile{-}based categories create meaningful groups}

\NormalTok{severity\_summary }\OtherTok{\textless{}{-}}\NormalTok{ timepoint\_data\_categorized }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(timepoint\_ordered, severity\_category) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{count =} \FunctionTok{n}\NormalTok{(), }\AttributeTok{.groups =} \StringTok{"drop"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(timepoint\_ordered) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{total =} \FunctionTok{sum}\NormalTok{(count),}
    \AttributeTok{percentage =}\NormalTok{ count }\SpecialCharTok{/}\NormalTok{ total }\SpecialCharTok{*} \DecValTok{100}
\NormalTok{  )}

\NormalTok{p3 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(severity\_summary, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ timepoint\_ordered, }\AttributeTok{y =}\NormalTok{ percentage, }\AttributeTok{fill =}\NormalTok{ severity\_category)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{position =} \StringTok{"stack"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.8}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{sprintf}\NormalTok{(}\StringTok{"n=\%d"}\NormalTok{, count)), }
            \AttributeTok{position =} \FunctionTok{position\_stack}\NormalTok{(}\AttributeTok{vjust =} \FloatTok{0.5}\NormalTok{), }
            \AttributeTok{size =} \DecValTok{3}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{fontface =} \StringTok{"bold"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_viridis\_d}\NormalTok{(}\AttributeTok{name =} \StringTok{"Severity}\SpecialCharTok{\textbackslash{}n}\StringTok{Category"}\NormalTok{, }\AttributeTok{option =} \StringTok{"plasma"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Bleaching Severity Category Distribution Across Timepoints"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Categories based on actual data quartiles, not arbitrary thresholds"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Time Period"}\NormalTok{, }
    \AttributeTok{y =} \StringTok{"Percentage of Sites (\%)"}\NormalTok{,}
    \AttributeTok{caption =} \StringTok{"This stacked bar chart reveals temporal patterns in bleaching severity.}\SpecialCharTok{\textbackslash{}n}\StringTok{Quartile{-}based categories ensure each severity level represents 25\% of}\SpecialCharTok{\textbackslash{}n}\StringTok{observed values, providing balanced and data{-}driven classifications.}\SpecialCharTok{\textbackslash{}n}\StringTok{Shifts between timepoints indicate recovery or deterioration patterns."}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \DecValTok{0}\NormalTok{, }\AttributeTok{size =} \DecValTok{9}\NormalTok{, }\AttributeTok{color =} \StringTok{"gray30"}\NormalTok{)}
\NormalTok{  )}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"01\_plot\_severity\_distributions.png"}\NormalTok{, p3, }\AttributeTok{width =} \DecValTok{10}\NormalTok{, }\AttributeTok{height =} \DecValTok{7}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Saved: 01\_plot\_severity\_distributions.png}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Saved: 01_plot_severity_distributions.png
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# SITE{-}LEVEL VARIABILITY ANALYSIS}
\CommentTok{\# ============================================================================}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{STEP 6: Analyzing site{-}level variability and consistency}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## STEP 6: Analyzing site-level variability and consistency
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## --------------------------------------------------------
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate coefficient of variation for each site across timepoints}
\CommentTok{\# Rationale: Some sites may be consistently high/low while others are highly variable}
\CommentTok{\# This identifies sites with stable vs. dynamic bleaching responses}

\NormalTok{site\_variability }\OtherTok{\textless{}{-}}\NormalTok{ timepoint\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(site) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{n\_timepoints =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{mean\_bleaching =} \FunctionTok{mean}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{sd\_bleaching =} \FunctionTok{sd}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{min\_bleaching =} \FunctionTok{min}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{max\_bleaching =} \FunctionTok{max}\NormalTok{(ext\_anybleaching, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{range\_bleaching =}\NormalTok{ max\_bleaching }\SpecialCharTok{{-}}\NormalTok{ min\_bleaching,}
    \AttributeTok{cv\_bleaching =}\NormalTok{ sd\_bleaching }\SpecialCharTok{/}\NormalTok{ mean\_bleaching,}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(n\_timepoints }\SpecialCharTok{\textgreater{}=} \DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# Only sites with sufficient data}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(cv\_bleaching))}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Sites with highest temporal variability (coefficient of variation):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Sites with highest temporal variability (coefficient of variation):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{head}\NormalTok{(site\_variability, }\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 8
##    site     n_timepoints mean_bleaching sd_bleaching min_bleaching max_bleaching
##    <chr>           <int>          <dbl>        <dbl>         <dbl>         <dbl>
##  1 Buck Is~            4          0.208        0.417         0             0.833
##  2 Cane Ba~            4          2.25         4.5           0             9    
##  3 Mutton ~            4          4.17         8.33          0            16.7  
##  4 St James            4          8.23        16.5           0            32.9  
##  5 Buck Is~            4         14.5         28.0           0            56.5  
##  6 South W~            4          4.47         7.65          0            15.9  
##  7 Great P~            4         23.9         38.9           0            81.4  
##  8 Gramman~            4         10.9         17.5           0.278        36.8  
##  9 Lang Ba~            4          5.42         8.29          0            17.5  
## 10 Kings C~            4         11.9         15.5           0            32.5  
## # i 2 more variables: range_bleaching <dbl>, cv_bleaching <dbl>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Sites with lowest temporal variability (most consistent):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Sites with lowest temporal variability (most consistent):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{tail}\NormalTok{(site\_variability, }\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 8
##    site     n_timepoints mean_bleaching sd_bleaching min_bleaching max_bleaching
##    <chr>           <int>          <dbl>        <dbl>         <dbl>         <dbl>
##  1 Salt Ri~            4            8           7.16          0             15  
##  2 Brewers~            4           16.9        13.9           0             34.1
##  3 Fish Bay            4           21.8        17.9           0             40.4
##  4 Coculus~            4           43.8        35.8           1.67          80.5
##  5 Botany ~            4           26.8        21.3           2.5           53.6
##  6 Eagle R~            4           20.8        16.0           0             33.3
##  7 Lang Ba~            4           31.0        23.6          10             63.3
##  8 Jacks B~            4           18.5        13.5           0             32.5
##  9 Buck Is~            4           22.4         7.76         16.7           33.8
## 10 Flat Cay            4           45.1        15.5          31.7           67.2
## # i 2 more variables: range_bleaching <dbl>, cv_bleaching <dbl>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate variability quartiles for site classification}
\NormalTok{variability\_quartiles }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(site\_variability}\SpecialCharTok{$}\NormalTok{cv\_bleaching, }\AttributeTok{probs =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.75}\NormalTok{, }\FloatTok{1.0}\NormalTok{), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Coefficient of variation quartiles:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Coefficient of variation quartiles:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(variability\_quartiles)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        0%       25%       50%       75%      100% 
## 0.3432474 0.8256799 1.0780154 1.5307499 2.0000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# VISUALIZATION 4: Site Variability Analysis}
\CommentTok{\# ============================================================================}

\CommentTok{\# Create scatter plot of mean vs. variability}
\CommentTok{\# Justification: Identifies sites with different response patterns {-} }
\CommentTok{\# some may be consistently impacted, others highly variable}

\NormalTok{site\_variability\_plot }\OtherTok{\textless{}{-}}\NormalTok{ site\_variability }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{variability\_category =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{      cv\_bleaching }\SpecialCharTok{\textless{}=}\NormalTok{ variability\_quartiles[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{\textasciitilde{}} \StringTok{"Low Variability"}\NormalTok{,}
\NormalTok{      cv\_bleaching }\SpecialCharTok{\textless{}=}\NormalTok{ variability\_quartiles[}\DecValTok{3}\NormalTok{] }\SpecialCharTok{\textasciitilde{}} \StringTok{"Moderate Variability"}\NormalTok{,}
\NormalTok{      cv\_bleaching }\SpecialCharTok{\textless{}=}\NormalTok{ variability\_quartiles[}\DecValTok{4}\NormalTok{] }\SpecialCharTok{\textasciitilde{}} \StringTok{"High Variability"}\NormalTok{, }
      \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \StringTok{"Extreme Variability"}
\NormalTok{    ),}
    \AttributeTok{variability\_category =} \FunctionTok{factor}\NormalTok{(variability\_category, }
                                  \AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Low Variability"}\NormalTok{, }\StringTok{"Moderate Variability"}\NormalTok{, }
                                             \StringTok{"High Variability"}\NormalTok{, }\StringTok{"Extreme Variability"}\NormalTok{))}
\NormalTok{  )}

\NormalTok{p4 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(site\_variability\_plot, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ mean\_bleaching, }\AttributeTok{y =}\NormalTok{ cv\_bleaching, }\AttributeTok{color =}\NormalTok{ variability\_category)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_viridis\_d}\NormalTok{(}\AttributeTok{name =} \StringTok{"Variability}\SpecialCharTok{\textbackslash{}n}\StringTok{Category"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Site{-}Level Bleaching Variability vs. Mean Impact"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Coefficient of variation reveals sites with consistent vs. dynamic responses"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Mean Bleaching Extent Across Timepoints (\%)"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Coefficient of Variation (SD/Mean)"}\NormalTok{,}
    \AttributeTok{caption =} \StringTok{"This plot identifies sites with different temporal response patterns.}\SpecialCharTok{\textbackslash{}n}\StringTok{Low variability sites may be consistently resilient or vulnerable.}\SpecialCharTok{\textbackslash{}n}\StringTok{High variability sites show dynamic responses that could indicate}\SpecialCharTok{\textbackslash{}n}\StringTok{recovery capacity or susceptibility to environmental fluctuations.}\SpecialCharTok{\textbackslash{}n}\StringTok{The trend line reveals whether high{-}impact sites are more variable."}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \DecValTok{0}\NormalTok{, }\AttributeTok{size =} \DecValTok{9}\NormalTok{, }\AttributeTok{color =} \StringTok{"gray30"}\NormalTok{))}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"01\_plot\_site\_variability.png"}\NormalTok{, p4, }\AttributeTok{width =} \DecValTok{10}\NormalTok{, }\AttributeTok{height =} \DecValTok{7}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Saved: 01\_plot\_site\_variability.png}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Saved: 01_plot_site_variability.png
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================================}
\CommentTok{\# SAVE PROCESSED DATASETS}
\CommentTok{\# ============================================================================}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{STEP 7: Saving processed datasets for downstream analysis}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## STEP 7: Saving processed datasets for downstream analysis
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ---------------------------------------------------------
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Save all processed datasets with metadata}
\FunctionTok{write\_csv}\NormalTok{(extent\_means, }\StringTok{"01\_extent\_site\_means.csv"}\NormalTok{)}
\FunctionTok{write\_csv}\NormalTok{(prevalence\_means, }\StringTok{"01\_prevalence\_site\_means.csv"}\NormalTok{)}
\FunctionTok{write\_csv}\NormalTok{(mortality\_means, }\StringTok{"01\_mortality\_site\_means.csv"}\NormalTok{)}

\CommentTok{\# Save threshold information for use in other scripts}
\NormalTok{thresholds\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{category =} \FunctionTok{c}\NormalTok{(}\StringTok{"minimal"}\NormalTok{, }\StringTok{"moderate"}\NormalTok{, }\StringTok{"high"}\NormalTok{, }\StringTok{"severe"}\NormalTok{),}
  \AttributeTok{upper\_threshold =} \FunctionTok{c}\NormalTok{(bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{minimal,}
\NormalTok{                      bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{moderate,}
\NormalTok{                      bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{high, }
\NormalTok{                      bleaching\_severity\_thresholds}\SpecialCharTok{$}\NormalTok{severe),}
  \AttributeTok{description =} \FunctionTok{c}\NormalTok{(}\StringTok{"0{-}25th percentile"}\NormalTok{, }\StringTok{"25th{-}50th percentile"}\NormalTok{, }
                  \StringTok{"50th{-}75th percentile"}\NormalTok{, }\StringTok{"75th{-}100th percentile"}\NormalTok{)}
\NormalTok{)}
\FunctionTok{write\_csv}\NormalTok{(thresholds\_data, }\StringTok{"01\_severity\_thresholds.csv"}\NormalTok{)}

\CommentTok{\# Save site variability analysis}
\FunctionTok{write\_csv}\NormalTok{(site\_variability\_plot, }\StringTok{"01\_site\_variability\_analysis.csv"}\NormalTok{)}

\CommentTok{\# Save complete sites list}
\FunctionTok{write\_csv}\NormalTok{(complete\_sites, }\StringTok{"01\_complete\_sites\_list.csv"}\NormalTok{)}

\CommentTok{\# ============================================================================}
\CommentTok{\# SUMMARY STATISTICS}
\CommentTok{\# ============================================================================}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{FINAL SUMMARY STATISTICS}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## FINAL SUMMARY STATISTICS
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"========================}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ========================
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"Total sites in dataset: \%d}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{n\_distinct}\NormalTok{(extent\_means}\SpecialCharTok{$}\NormalTok{site)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Total sites in dataset: 33
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"Sites with complete 4{-}timepoint data: \%d}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(complete\_sites)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Sites with complete 4-timepoint data: 33
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"Total site{-}year{-}period combinations: \%d}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(extent\_means)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Total site-year-period combinations: 165
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Bleaching severity thresholds (data{-}driven quartiles):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Bleaching severity thresholds (data-driven quartiles):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(thresholds\_data)) \{}
  \FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"  \%s: ≤\%.1f\%\% (\%s)}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }
              \FunctionTok{str\_to\_title}\NormalTok{(thresholds\_data}\SpecialCharTok{$}\NormalTok{category[i]),}
\NormalTok{              thresholds\_data}\SpecialCharTok{$}\NormalTok{upper\_threshold[i],}
\NormalTok{              thresholds\_data}\SpecialCharTok{$}\NormalTok{description[i]))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Minimal: ≤0.0% (0-25th percentile)
##   Moderate: ≤9.1% (25th-50th percentile)
##   High: ≤31.9% (50th-75th percentile)
##   Severe: ≤81.4% (75th-100th percentile)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Files saved:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Files saved:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"  {-} 01\_extent\_site\_means.csv (processed extent data)}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   - 01_extent_site_means.csv (processed extent data)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"  {-} 01\_prevalence\_site\_means.csv (processed prevalence data)}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   - 01_prevalence_site_means.csv (processed prevalence data)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"  {-} 01\_mortality\_site\_means.csv (processed mortality data)}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   - 01_mortality_site_means.csv (processed mortality data)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"  {-} 01\_severity\_thresholds.csv (data{-}driven thresholds)}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   - 01_severity_thresholds.csv (data-driven thresholds)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"  {-} 01\_site\_variability\_analysis.csv (site variability metrics)}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   - 01_site_variability_analysis.csv (site variability metrics)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"  {-} 01\_complete\_sites\_list.csv (sites with complete data)}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   - 01_complete_sites_list.csv (sites with complete data)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Visualizations saved:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Visualizations saved:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"  {-} 01\_plot\_data\_availability\_matrix.png}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   - 01_plot_data_availability_matrix.png
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"  {-} 01\_plot\_bleaching\_distributions.png}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   - 01_plot_bleaching_distributions.png
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"  {-} 01\_plot\_severity\_distributions.png}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   - 01_plot_severity_distributions.png
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"  {-} 01\_plot\_site\_variability.png}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   - 01_plot_site_variability.png
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{============================================================================}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## ============================================================================
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"STEP 1 COMPLETE: Data loaded, processed, and thresholds established}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## STEP 1 COMPLETE: Data loaded, processed, and thresholds established
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Next: Temperature and DHW analysis using these data{-}driven thresholds}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Next: Temperature and DHW analysis using these data-driven thresholds
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"============================================================================}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ============================================================================
\end{verbatim}

\end{document}
